<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}TrendZee — Social Signal Intelligence{% endblock %}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Geist:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  {% block extra_css %}{% endblock %}
  <script>
    (function () {
      var t = localStorage.getItem('tz-theme') || 'dark';
      document.documentElement.setAttribute('data-theme', t);
    })();
  </script>
</head>

<body>

  <div class="bg-canvas"></div>
  <div class="noise-overlay"></div>
  <div class="grid-lines"></div>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="{% url 'landing' %}" class="nav-logo">
        <div class="logo-mark">TZ</div>
        <span class="logo-text">TrendZee</span>
      </a>
      <div class="nav-links" id="navLinks">
        <a href="{% url 'dashboard' %}" class="nav-link">Dashboard</a>
        {% if user.is_authenticated %}
        <a href="{% url 'saved_trends' %}" class="nav-link">Saved</a>
        <a href="{% url 'chatbot' %}" class="nav-link">AI Chat</a>
        {% if not user.is_premium %}
        <a href="{% url 'upgrade' %}" class="nav-link nav-link--premium">⚡ Upgrade</a>
        {% endif %}
        {% endif %}
      </div>
      <div class="nav-actions">
        <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle theme"
          style="background:none;border:1px solid var(--b-subtle);border-radius:var(--r-sm);width:34px;height:34px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;color:var(--t-secondary);transition:all .2s">
          <i class="fas fa-moon" id="themeIcon"></i>
        </button>
        {% if user.is_authenticated %}
        <div class="nav-user-menu">
          <button class="nav-avatar" onclick="toggleUserMenu()">{{ user.display_name|slice:":1"|upper }}</button>
          <div class="user-dropdown" id="userDropdown">
            <div class="dropdown-header">
              <div class="dropdown-email">{{ user.email }}</div>
              {% if user.is_premium %}<span class="badge-premium" style="margin-top:5px;display:inline-block">⚡
                Premium</span>{% endif %}
            </div>
            <a href="{% url 'profile' %}" class="dropdown-item"><i class="fas fa-user"></i> Profile</a>
            <a href="{% url 'dashboard' %}" class="dropdown-item"><i class="fas fa-chart-line"></i> Dashboard</a>
            <form method="post" action="{% url 'logout' %}">
              {% csrf_token %}
              <button type="submit" class="dropdown-item dropdown-item--logout"><i class="fas fa-sign-out-alt"></i> Log
                Out</button>
            </form>
          </div>
        </div>
        {% else %}
        <a href="{% url 'login' %}" class="btn-ghost btn" style="font-size:13px">Log In</a>
        <a href="{% url 'register' %}" class="btn-nav">Get Started</a>
        {% endif %}
      </div>
      <button class="nav-mobile-toggle" onclick="toggleMobileNav()">
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <!-- Messages -->
  {% if messages %}
  <div class="messages-container">
    {% for message in messages %}
    <div class="message message--{{ message.tags }}">
      <span>{{ message|safe }}</span>
      <button onclick="this.parentElement.remove()" class="message-close">×</button>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <main class="main-content">{% block content %}{% endblock %}</main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-brand">
        <div class="logo-mark logo-mark--sm">TZ</div>
        <p class="footer-tagline">Social Signal Intelligence Platform</p>
      </div>
      <div class="footer-links">
        <a href="{% url 'about' %}">About</a>
        <a href="#">Contact</a>
        <a href="{% url 'privacy' %}">Privacy</a>
      </div>
      <div class="footer-copy">&copy; {% now "Y" %} TrendZee. Built for signal.</div>
    </div>
  </footer>

  <script src="{% static 'js/main.js' %}"></script>
  {% block extra_js %}{% endblock %}
</body>

</html>